<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Profit & Loss Practice Test â€” Mobile App UI</title>
<style>
    /* ---------------------------------------------------- */
    /* 1. Global Setup & Variables */
    /* ---------------------------------------------------- */
    :root {
        --main-bg: #f0f4f8; /* Light gray background */
        --card-bg: #ffffff;
        --text-dark: #1e293b;
        --text-muted: #64748b;
        --accent-red: #ef4444; /* Active pill color */
        --accent-primary: #0ea5e9; /* Option selection color */
        --border: #e2e8f0;
        --success: #10b981;
        --shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    /* 2. Base Layout (Mobile First) */
    body {
        margin: 0;
        font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        background: var(--main-bg);
        color: var(--text-dark);
        /* Space for fixed header (2 lines) and footer */
        padding-top: 135px;
        padding-bottom: 70px;
    }
    .container {
        /* Limits content width to look like a phone screen */
        max-width: 600px; 
        margin: 0 auto;
        padding: 0 15px;
    }
    .quiz-content {
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: var(--shadow);
        padding: 20px;
        margin-bottom: 15px;
    }

    /* ---------------------------------------------------- */
    /* 3. Fixed Header and Navigation Bar */
    /* ---------------------------------------------------- */
    .header-fixed {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: var(--card-bg);
        box-shadow: var(--shadow);
        z-index: 1000;
        border-bottom: 1px solid var(--border);
    }
    .header-title-bar {
        max-width: 600px;
        margin: 0 auto;
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
        font-weight: 500;
        color: var(--text-dark);
    }
    .header-title-bar .back-btn {
        font-size: 24px;
        cursor: pointer;
        margin-right: 15px;
        color: var(--text-dark);
    }
    
    /* Timer Style */
    .header-title-bar .timer{
Â  Â  Â  Â  color: var(--accent-red);
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .header-title-bar .timer span{ margin-left: 5px; }


    /* Progress Pills Container (Second line of the header) */
    .pill-nav-container {
        padding: 10px 15px;
        max-width: 600px;
        margin: 0 auto;
        overflow-x: scroll; 
        -webkit-overflow-scrolling: touch;
    }
    .pill-nav {
        display: flex;
        gap: 8px;
        padding-bottom: 5px; 
        width: max-content; 
    }
    .pill {
        flex-shrink: 0;
        width: 38px;
        height: 38px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        border: 1px solid var(--border);
        background: #f8fafc;
        color: var(--text-dark);
        transition: all 0.2s;
    }
    .pill.all-btn {
        width: auto; 
        border-radius: 8px;
        padding: 0 15px;
        background: var(--text-dark); /* Dark background for 'All' pill */
        color: var(--card-bg);
    }
    .pill.answered {
        background: var(--success);
        color: var(--card-bg);
        border-color: var(--success);
    }
    .pill.active {
        background: var(--accent-red);
        color: var(--card-bg);
        border-color: var(--accent-red);
    }

    /* ---------------------------------------------------- */
    /* 4. Question & Options Styling */
    /* ---------------------------------------------------- */
    .question-meta {
        color: var(--text-muted);
        font-size: 14px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px dashed var(--border);
        padding-bottom: 10px;
    }
    .qtext {
        font-size: 18px;
        margin-bottom: 25px;
        font-weight: 500;
        line-height: 1.5;
    }
    
    .options {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    label.option {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        border-radius: 10px;
        border: 1px solid var(--border);
        cursor: pointer;
        background: #f8fafc;
        transition: background 0.1s, border-color 0.1s;
        font-size: 16px;
    }
    /* Hide native radio button to use custom styling */
    input[type=radio] {
        display: none;
    }
    
    /* Custom circular option label (A, B, C, D) */
    .option-label {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: 600;
        margin-right: 15px;
        border: 1px solid var(--text-muted);
        color: var(--text-muted);
        background: var(--card-bg);
        transition: all 0.2s;
    }
    /* Visual feedback on selection */
    label.option.selected {
        border-color: var(--accent-primary);
        background: #e0f2fe;
        font-weight: 500;
    }
    label.option.selected .option-label {
        background: var(--accent-primary);
        color: var(--card-bg);
        border-color: var(--accent-primary);
    }
    
    /* Hint and Report Styling */
    .action-bar{
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  font-size: 14px;
Â  Â  }
Â  Â  .hint-btn{color: var(--text-muted); cursor: pointer; border: none; background: none; font-weight: 500;}
Â  Â  .report-btn { color: var(--accent-red); cursor: pointer; }
    .hint-area{
Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  background: #f0fdf4;
Â  Â  Â  Â  border: 1px solid #dcfce7;
Â  Â  Â  Â  color: #065f46;
Â  Â  Â  Â  font-size: 14px;
Â  Â  }

    /* ---------------------------------------------------- */
    /* 5. Fixed Footer and Buttons */
    /* ---------------------------------------------------- */
    .footer-fixed {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--card-bg);
        border-top: 1px solid var(--border);
        z-index: 1000;
    }
    .footer-inner {
        max-width: 600px;
        margin: 0 auto;
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
    }
    .btn {
        background: var(--accent-primary);
        color: #fff;
        padding: 12px 20px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-weight: 600;
        transition: background 0.2s;
    }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    
    .hidden { display: none !important; }
</style>
</head>
<body>
    
    <div class="header-fixed">
        <div class="header-title-bar">
            <div style="display:flex; align-items:center;">
                <span class="back-btn">â®œ</span>
                <span id="quizTitle">Profit And Loss Practice Test</span>
            </div>
            <span class="timer">â±ï¸ <span id="quizTimer">00:00:00</span></span>
        </div>
        
        <div class="pill-nav-container hidden" id="pillNavContainer">
            <div class="pill-nav" id="pillNav">
                <div class="pill all-btn">All</div>
                </div>
        </div>
    </div>
    <div class="container" role="application">
        
        <div class="quiz-content" id="startScreen">
            <h2 style="text-align:center;">Welcome to the Profit & Loss Practice Test</h2>
            <p style="color:var(--text-muted); text-align:center;">
                This test contains **35** randomized questions. Click 'Start Quiz' to begin. The timer will start immediately.
            </p>
            <div style="text-align:center; margin-top:30px;">
                <button class="btn" id="startBtn">Start Quiz Now</button>
            </div>
        </div>
        
        <div id="quizArea" class="quiz-content hidden">
            </div>

        <div id="resultArea" class="quiz-content hidden"></div>
        
    </div>

    <div class="footer-fixed">
        <div class="footer-inner">
            <div style="display:flex; gap:10px;">
                <button class="btn" id="prevBtn" disabled>â—€ Prev</button>
                <button class="btn" id="nextBtn" disabled>Next â–¶</button>
            </div>
            <div>
                <button class="btn" id="submitBtn" disabled>Submit Quiz</button>
            </div>
        </div>
    </div>
    <script>
        // --- DATA: ALL 35 QUESTIONS WITH CORRECTED ANSWERS ---
        const QUESTIONS = [
            { id:7, q:"If a book is sold at 25% loss, then ratio of cost price to the selling price is:", choices:["3 : 2","4 : 3","5 : 4","2 : 3"], answer:1, hint:"Basic CP:SP ratio (loss) â€” (100:75 or 4:3)"},
            { id:8, q:"An article is sold at a profit of 250%. What is the ratio of its cost price to selling price?", choices:["2 : 5","5 : 2","2 : 7","7 : 2"], answer:2, hint:"Basic profit% â†’ ratio (100:350 or 2:7)"},
            { id:13, q:"A shopkeeper sold an article at 26 2/3% profit. If the selling price is â‚¹1600, find the cost price.", choices:["â‚¹1200","â‚¹1400","â‚¹1500","None of these"], answer:1, hint:"Reverse percentage (SP â†’ CP)"},
            { id:14, q:"By selling a hair oil product for â‚¹336, the gain is 12%. If the gain is reduced to 9%, find the resultant selling price (â‚¹).", choices:["â‚¹330","â‚¹300","â‚¹327","â‚¹339"], answer:2, hint:"Change in profit% â€” recompute SP"},
            { id:16, q:"By selling an article for â‚¹19.50, a dealer makes a profit of 30%. By how much should he increase his selling price so as to make a profit of 40%?", choices:["â‚¹3","â‚¹1.75","â‚¹2","â‚¹1.50"], answer:3, hint:"Profit% on fixed CP â†’ find CP, then new SP"},
            { id:18, q:"A blanket is sold for â‚¹1,148, resulting in a loss of 30%. For how much should it be sold to gain 5%?", choices:["â‚¹1,423","â‚¹1,734","â‚¹1,543","â‚¹1,722"], answer:3, hint:"Loss â†’ compute CP â†’ desired SP for gain"},
            { id:19, q:"When an article is sold for â‚¹480, there is a loss of 2 16/3 %. To gain 1 8/3 %, it should be sold for (â‚¹):", choices:["â‚¹620","â‚¹624","â‚¹605","â‚¹750"], answer:0, hint:"Loss is 7.333% (22/3%). Gain is 3.666% (11/3%). Calculate CP, then new SP. (Ans: 620)"},
            { id:20, q:"By selling an article for â‚¹2,200, a profit of 10% is earned. If the same article is sold for â‚¹2,600, then what will be the gain percentage?", choices:["20%","15%","37%","30%"], answer:3, hint:"Compare SPs to CP (CP=2000) â†’ find % (30%)"},
            { id:22, q:"An article is sold for â‚¹2070 at a profit of 15%. If the article is sold for â‚¹1890, then what will be gain or loss percent ?", choices:["10% gain","10% loss","5% gain","5% loss"], answer:3, hint:"Two SP values â†’ compare to CP"},
            { id:23, q:"Manjeet bought a second-hand motorbike for â‚¹22,000 and spent â‚¹3,000 on overhaul. He then sold it with 12% profit. If he had sold it for â‚¹500 less, what would have been his profit percentage?", choices:["10%","10.5%","8%","5%"], answer:0, hint:"Profit on total cost (CP + expenses)"},
            { id:24, q:"A retailer purchased a batch of goods for â‚¹5,000. 5% of the goods were damaged. If retailer wants 20% profit on remaining goods, at what total price should the undamaged goods be sold?", choices:["â‚¹5,700","â‚¹5,800","â‚¹6,000","â‚¹5,900"], answer:2, hint:"Effective selling price after shrinkage"},
            { id:25, q:"The difference between cost price and selling price of an article is â‚¹1,800. If there is a profit of 20%, then the cost price of the article is:", choices:["â‚¹9,000","â‚¹8,000","â‚¹11,000","â‚¹7,000"], answer:0, hint:"Difference = SPâˆ’CP, use profit% to find CP"},
            { id:27, q:"A shopkeeper sold an article at 26% profit. On selling it for â‚¹2,250 more, he would get 41% profit. If it is sold at 12% profit, then the selling price would be:", choices:["â‚¹16,800","â‚¹15,000","â‚¹15,800","â‚¹16,120"], answer:3, hint:"Solve two-SP linear system â†’ find CP"},
            { id:28, q:"A trader sells an article at 16% below cost. Had he sold it for â‚¹192.20 more, he would have gained 15%. The new selling price is (â‚¹):", choices:["742","731","713","724"], answer:2, hint:"Relative SP adjustments â†’ find original CP then new SP"},
            { id:31, q:"When an article is sold for â‚¹768, profit% is x%. When sold for â‚¹896, profit% is (x+20)%. What is x?", choices:["20","15","25","30"], answer:0, hint:"Two SPs same CP â†’ deduce x (20%)"},
            { id:59, q:"A trader bought some oranges at 7 for â‚¹11. He sold all at 2 for â‚¹3. Thereby he loses â‚¹30. Find number of oranges sold.", choices:["420","400","210","280"], answer:0, hint:"Unit price â†’ total loss â†’ find quantity (420)"},
            { id:60, q:"A trader bought some apples at 15 for â‚¹8 and sold all at X for â‚¹2. Thereby he gains 25%. Find X (apples per â‚¹2).", choices:["2","3","4","5"], answer:2, hint:"Unit-rate & profit% â†’ find X (4)"},
            { id:61, q:"A trader bought apples at 9 for â‚¹7. He sold at X for â‚¹2 and thereby lost 2 14/7%. Find X.", choices:["2","3","4","5"], answer:3, hint:"Find selling-rate for given loss% (5)"},
            { id:62, q:"Bought some articles at 11 for â‚¹10 and same number at 9 for â‚¹10. Sold all at 1 for â‚¹1. Find profit or loss %.", choices:["No profit no loss","20% profit","10% loss","1% loss"], answer:3, hint:"Weighted average cost â†’ combined SP (1% loss)"},
            { id:64, q:"Shopkeeper buys 60 oranges at 10 for â‚¹72 and same number at 12 for â‚¹90. Spends â‚¹118 extra. Total profit 26%. Selling price of 32 oranges is:", choices:["â‚¹336","â‚¹313.60","â‚¹316.80","â‚¹320"], answer:2, hint:"Combined CP + overheads â†’ compute unit SP (316.80)"},
            { id:67, q:"Mukesh sells 80% of commodity at 20% profit and rest at 5% loss, earning total profit â‚¹9,300. What was the cost price?", choices:["â‚¹61,000","â‚¹58,000","â‚¹62,000","â‚¹60,000"], answer:0, hint:"Weighted-average profit â†’ find total CP (61,000)"},
            { id:71, q:"A person sold 1/3 articles at 14%, 3/5 at 17.5% and rest at 20%. Find overall profit% (approx).", choices:["15.5%","16.5%","17.5%","18.5%"], answer:1, hint:"Weighted average of percentages (Approx 16.5%)"},
            { id:73, q:"A medical store purchased medicines â‚¹18,000; sold 2/5 at 35% loss. At what gain should he sell rest to neither gain nor lose?", choices:["1/23%","2/20%","2/23%","1/20%"], answer:2, hint:"Balance losses with gains to zero total profit (2/23%)"},
            { id:74, q:"If 2/3 articles sold at 25% profit, 20% at 20% loss and remaining at 20% profit, profit â‚¹3,312 is obtained. Find cost price.", choices:["â‚¹18,600","â‚¹21,400","â‚¹21,600","â‚¹20,000"], answer:3, hint:"Weighted profits across fractions (20,000)"},
            { id:76, q:"Bought apples for â‚¹3,600. Sold 1/5 at 10% loss, 1/4 of remainder at 5% loss, two-thirds of rest at 15% profit. At what price should he sell remaining to earn 27% overall?", choices:["â‚¹1,548","â‚¹1,584","â‚¹1,845","â‚¹1,864"], answer:1, hint:"Multi-stage fraction sales â†’ compute required SP (1,584)"},
            { id:77, q:"Arbind has 650 kg wheat. Part he sells at 9% profit and rest at 19% profit to get 15% overall. Quantity sold at 9% profit (kg) is:", choices:["260","390","195","455"], answer:0, hint:"Mixture profit â†’ weighted average â†’ find part (260 kg)"},
            { id:80, q:"Pradeep sells two fans at â‚¹480 each â€” gains 20% on one and loses 20% on the other. His loss on the whole (â‚¹) is:", choices:["30","10","20","40"], answer:2, hint:"Same SP, differing % â†’ compute absolute loss (20)"},
            { id:82, q:"Radha bought fridge + washing machine together for â‚¹57,300. She sold fridge at 15% profit and washing machine at 24% loss and both sold at same price. What is CP of washing machine?", choices:["â‚¹22,800","â‚¹28,650","â‚¹34,500","â‚¹24,500"], answer:1, hint:"Two-item CPs with equal SP â†’ solve algebraically (28,650)"},
            { id:86, q:"Two articles sold for â‚¹3,000 each. No net loss/gain. If one sold at 25% profit, loss on second is:", choices:["10%","18 2/3%","16 2/3%","15 2/3%"], answer:2, hint:"Same SP pair â†’ find complementary loss (16 2/3%)"},
            { id:87, q:"Two articles sold for â‚¹2,400 each; overall no profit/no loss. If one sold at 20% profit, what loss was on the other (â‚¹)?", choices:["â‚¹600","â‚¹400","â‚¹380","â‚¹240"], answer:1, hint:"Same-SP two-article balancing (400)"},
            { id:97, q:"A trader marks up 20% on CP and gives 10% discount on the marked price. Overall profit% is:", choices:["8%","10%","12%","6%"], answer:0, hint:"Markup & discount â†’ effective profit% (8%)"},
            { id:98, q:"A shopkeeper wants to gain 25% on CP. He should mark his goods at what percent above CP if he offers 20% discount on marked price?", choices:["56.25%","45%","31.25%","25%"], answer:2, hint:"Desired net profit with discount â†’ compute markup (31.25%)"},
            { id:99, q:"If CP of 5 items is equal to SP of 4 items, profit% is:", choices:["25%","20%","15%","10%"], answer:0, hint:"CP of X = SP of Y type (25%)"},
            { id:100, q:"An article is sold at two successive discounts of 10% and 20% on MRP. Net discount percent is:", choices:["28%","30%","18%","32%"], answer:0, hint:"Successive discount calculation (28%)"},
            { id:105, q:"A wholesaler gives 8% discount on CP and still earns 10% profit. If CP is â‚¹500, what is selling price?", choices:["â‚¹540","â‚¹594","â‚¹550","â‚¹540"], answer:2, hint:"Discount on CP + profit â†’ compute SP (550)"},
        ];
        
        // App state
        let state = {
            order: QUESTIONS.map((_, i) => i), 
            optOrders: [],
            currentIndex: 0,
            answers: Array(QUESTIONS.length).fill(null),
            started: false,
            submitted: false,
            startTime: null,
            timerInterval: null
        };

        const qcount = QUESTIONS.length; 
        const [startBtn, startScreen, quizArea, prevBtn, nextBtn, submitBtn] = 
            ['startBtn', 'startScreen', 'quizArea', 'prevBtn', 'nextBtn', 'submitBtn'].map(id => document.getElementById(id));
        const [pillNavContainer, pillNav] = 
            ['pillNavContainer', 'pillNav'].map(id => document.getElementById(id));
        const quizTimer = document.getElementById('quizTimer');
        
        function shuffleArray(a){
            for(let i=a.length-1;i>0;i--){
                const j=Math.floor(Math.random()*(i+1));
                [a[i],a[j]]=[a[j],a[i]];
            }
        }

        // --- Timer Functions ---
        function formatTime(totalSeconds) {
            const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const seconds = String(totalSeconds % 60).padStart(2, '0');
            return `${hours}:${minutes}:${seconds}`;
        }

        function startTimer() {
            state.startTime = Date.now();
            
            if (state.timerInterval) clearInterval(state.timerInterval);
            
            state.timerInterval = setInterval(() => {
                const elapsedSeconds = Math.floor((Date.now() - state.startTime) / 1000);
                quizTimer.textContent = formatTime(elapsedSeconds);
            }, 1000);
        }

        
        function initializeOptionOrders() {
            state.optOrders = [];
            QUESTIONS.forEach(() => {
                const optionsIndices = [0, 1, 2, 3];
                shuffleArray(optionsIndices);
                state.optOrders.push(optionsIndices);
            });
        }
        initializeOptionOrders(); 

        function generatePills() {
            pillNav.querySelectorAll('.pill:not(.all-btn)').forEach(p => p.remove());
            state.order.forEach((_, idx) => {
                const pill = document.createElement('div');
                pill.className = 'pill';
                pill.textContent = idx + 1;
                pill.setAttribute('data-index', idx);
                pill.onclick = () => navigateToQuestion(idx);
                pillNav.appendChild(pill);
            });
        }

        function updatePillStatus() {
            const pills = pillNav.querySelectorAll('.pill:not(.all-btn)');
            pills.forEach((pill, idx) => {
                const qIdx = state.order[idx];
                pill.classList.remove('active', 'answered');

                if (idx === state.currentIndex) {
                    pill.classList.add('active');
                } else if (state.answers[qIdx] !== null) {
                    pill.classList.add('answered');
                }
                
                // Scroll to active pill
                if (idx === state.currentIndex) {
                    const scrollLeft = pill.offsetLeft - pillNavContainer.clientWidth / 2 + pill.clientWidth / 2;
                    pillNavContainer.scrollLeft = scrollLeft;
                }
            });
        }

        function renderQuestion(idx) {
            const qIdx = state.order[idx];
            const item = QUESTIONS[qIdx];
            const chosenOriginalIndex = state.answers[qIdx];
            const optOrder = state.optOrders[qIdx];

            quizArea.innerHTML = '';
            
            // 1. Question Meta (e.g., "2 of 35")
            const meta = document.createElement('div');
            meta.className = 'question-meta';
            meta.innerHTML = `<span>**${idx + 1}** of ${qcount}</span><span class="report-btn">Report ğŸš©</span>`;
            quizArea.appendChild(meta);

            // 2. Question Text
            const qtext = document.createElement('div');
            qtext.className = 'qtext';
            qtext.innerHTML = item.q;
            quizArea.appendChild(qtext);

            // 3. Options Area
            const opts = document.createElement('div');
            opts.className = 'options';
            
            optOrder.forEach((originalCi, shuffledCi) => {
                const ch = item.choices[originalCi];
                const isChosen = chosenOriginalIndex === originalCi;
                const label = document.createElement('label');
                label.className = `option ${isChosen ? 'selected' : ''}`;
                label.setAttribute('data-original-index', originalCi);
                
                const optionLabel = String.fromCharCode(65 + shuffledCi); // A, B, C, D
                
                label.innerHTML = `
                    <input type="radio" name="q${qIdx}" value="${originalCi}" ${isChosen ? 'checked' : ''}> 
                    <span class="option-label">${optionLabel}</span> 
                    <span>${ch}</span>
                `;
                
                label.onclick = () => {
                    const selectedOriginalIndex = parseInt(label.getAttribute('data-original-index'));
                    state.answers[qIdx] = selectedOriginalIndex;
                    
                    // Visual update for selected option
                    Array.from(opts.querySelectorAll('label')).forEach(l => l.classList.remove('selected'));
                    label.classList.add('selected');
                    
                    updateNavAndSubmit();
                    updatePillStatus();
                };
                opts.appendChild(label);
            });
            quizArea.appendChild(opts);

            // 4. Hint Control
            const actionBar = document.createElement('div');
            actionBar.className = 'action-bar';
            actionBar.innerHTML = `<button class="hint-btn" id="hintToggle">Show Hint / Explanation</button>`;
            quizArea.appendChild(actionBar);
            
            // 5. Hidden Hint Box
            const hintBox = document.createElement('div');
            hintBox.className='hint-area hidden'; // Start hidden
            hintBox.id = 'hintBox';
            hintBox.innerHTML = `**Hint/Explanation:** ${item.hint}`;
            quizArea.appendChild(hintBox);

            document.getElementById('hintToggle').onclick = (e)=>{
                e.preventDefault();
                const isHidden = hintBox.classList.toggle('hidden');
                e.target.textContent = isHidden ? 'Show Hint / Explanation' : 'Hide Hint / Explanation';
            };


            updateNavAndSubmit();
            updatePillStatus();
        }

        function navigateToQuestion(idx) {
            if (idx >= 0 && idx < qcount) {
                state.currentIndex = idx;
                renderQuestion(idx);
            }
        }

        function updateNavAndSubmit() {
            const answeredCount = state.answers.filter(a => a !== null).length;
            const allAnswered = answeredCount === qcount;

            submitBtn.disabled = !allAnswered;
            prevBtn.disabled = state.currentIndex === 0;
            nextBtn.disabled = state.currentIndex === qcount - 1;
        }

        // --- Event Listeners ---
        startBtn.addEventListener('click', () => {
            shuffleArray(state.order); 
            state.started = true;
            startScreen.classList.add('hidden');
            quizArea.classList.remove('hidden');
            pillNavContainer.classList.remove('hidden');

            generatePills();
            startTimer(); // Start the timer!
            navigateToQuestion(state.currentIndex);
        });

        prevBtn.addEventListener('click', () => navigateToQuestion(state.currentIndex - 1));
        nextBtn.addEventListener('click', () => navigateToQuestion(state.currentIndex + 1));
        
        submitBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to submit the quiz?')) {
                state.submitted = true;
                clearInterval(state.timerInterval); // Stop the timer
                
                quizArea.classList.add('hidden');
                document.getElementById('resultArea').classList.remove('hidden');
                
                let correctCount = 0;
                QUESTIONS.forEach((q, i) => { if (state.answers[i] === q.answer) correctCount++; });
                
                document.getElementById('resultArea').innerHTML = `
                    <h2>Quiz Submitted!</h2>
                    <h3>Score: **${correctCount} / ${qcount}**</h3>
                    <p>Time Taken: ${quizTimer.textContent}</p>
                    <p style="text-align:center; margin-top: 15px;">Thanks for completing the test.</p>
                `;
                
                prevBtn.disabled = true; nextBtn.disabled = true; submitBtn.disabled = true;
            }
        });

        document.querySelector('.back-btn').addEventListener('click', () => {
             alert('Back action triggered! This would normally exit the test.');
        });
    </script>
</body>
</html>
